# # action.yaml
# name: 'Custom GitHub Action'
# description: 'A GitHub Action that takes an input and returns the square of the number'
# inputs:
#   num:
#     description: 'Enter a number'
#     required: true
#     default: "1"
# outputs:
#   num_squared:
#     description: 'Square of the input'
#     # need to specify the extra `value` field for `composite` actions
#     value: ${{ steps.get-square.outputs.num_squared }}
# runs:
#   using: 'composite'
#   steps:
#     - name: Install Python
#       uses: actions/setup-python@v4
#       with:
#         python-version: '3.10'  
#     - name: Install Dependencies
#       run: pip install -r requirements.txt
#       shell: bash
#     - name: Pass Inputs to Shell
#       run: |
#               echo "INPUT_NUM=${{ inputs.num }}" >> $GITHUB_ENV
#       shell: bash
#     - name: Fetch the number's square
#       id: get-square
#       run: python src/get_num_square.py
#       shell: bash


# Sample workflow to access AWS resources when workflow is tied to branch
# The workflow Creates static website using aws s3
---
name: AWS example workflow
on:
  push
env:
  BUCKET_NAME : "cloudbank-terraform-backend"
  AWS_REGION : "ap-southeast-1"
# permission can be added at job level or workflow level    
permissions:
      id-token: write   # This is required for requesting the JWT
      contents: read    # This is required for actions/checkout
runs:
  runs-on: ubuntu-latest
  steps:
    - name: Git clone the repository
      uses: actions/checkout@v3
    - name: configure aws credentials
      uses: aws-actions/configure-aws-credentials@v2
      with:
        role-to-assume: arn:aws:iam::772371761711:role/github-actions-role
        role-session-name: samplerolesession
        aws-region: "ap-southeast-1"
    # Upload a file to AWS s3
    - name:  Copy index.html to s3
      id: get-square
      run: |
        aws s3 ls